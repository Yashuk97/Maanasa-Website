<!DOCTYPE html>
<html lang="en">
<head>
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Maanasa Constructions{% endblock %}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <script src="https://kit.fontawesome.com/9741edfba4.js" crossorigin="anonymous"></script></head>
<body>
    <header class="main-header">
        <div class="logo">
            <a href="/">
                <img src="{{ url_for('static', filename='images/logo.png') }}" alt="Maanasa Constructions Logo">
            </a>
        </div>
        <nav class="main-nav">
            <a href="/">Home</a> |
            <a href="/about">About Us</a> |
            <a href="/services">Services</a> |
            <a href="/contact">Contact</a>
        </nav>
    </header>
    <main>
        {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
        <div class="flashes">
            {% for category, message in messages %}
            <div class="alert alert-{{ category }}">
                {{ message }}
            </div>
            {% endfor %}
        </div>
        {% endif %}
        {% endwith %}
        {% block content %}
        {% endblock %}
    </main>
    <footer>
        <div class="footer-content">
            <div class="footer-left">
                <img src="{{ url_for('static', filename='images/logo.png') }}" alt="Maanasa Constructions Logo" class="footer-logo">
                <p class="company-quote">Building with trust, designed with love</p>
            </div>
            <div class="footer-right">
    <p>Follow Us & Get in Touch</p>
    <div class="socials-container">
        <a href="mailto:maanasa.inquiries@gmail.com" target="_blank">
            <i class="fa-solid fa-envelope"></i>
        </a>
        <a href="https://twitter.com/your-twitter-handle" target="_blank">
            <i class="fa-brands fa-twitter"></i>
        </a>
        <a href="https://instagram.com/your-instagram-handle" target="_blank">
            <i class="fa-brands fa-instagram"></i>
        </a>
    </div>
</div>
        </div>
    </footer>
    <div class="chatbot-wrapper">
    <button id="chat-icon-button">
        <img src="{{ url_for('static', filename='images/chatbotlogo.png') }}" alt="Chatbot Icon" class="chatbot-icon">
    </button>

    <div class="chatbot-container" style="display: none;">
        <div class="chatbot-header">Maanasa Bot
            <button id="close-chatbot-button">x</button>
        </div>
        <div class="chatbot-messages"></div>
        <div class="chatbot-input">
            <input type="text" placeholder="Type a message...">
        </div>
    </div>
</div>
    <script>
    // Get references to all the HTML elements
    const chatIconButton = document.getElementById('chat-icon-button');
    const chatWindow = document.querySelector('.chatbot-container');
    const chatbox = document.querySelector('.chatbot-messages');
    const input = document.querySelector('.chatbot-input input');
    const closeChatbotButton = document.getElementById('close-chatbot-button');



    // 1. Logic for showing/hiding the chatbot
    chatIconButton.addEventListener('click', function() {
        chatWindow.style.display = 'flex';
        chatIconButton.style.display = 'none';
    });
    //3. logic for closing the chatbot window
    closeChatbotButton.addEventListener('click', function() {
    chatWindow.style.display = 'none';
    chatIconButton.style.display = 'flex';
    });

    // 2. Logic for sending and receiving messages
    input.addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
            const userMessage = input.value.trim();
            if (userMessage) {
                // Display user message
                const userMsgDiv = document.createElement('div');
                userMsgDiv.className = 'message user';
                userMsgDiv.textContent = userMessage;
                chatbox.appendChild(userMsgDiv);

                // Send message to backend
                fetch('/chatbot-api', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ message: userMessage }),
                })
                .then(response => response.json())
                .then(data => {
                    const botMessage = data.response;
                    const botMsgDiv = document.createElement('div');
                    botMsgDiv.className = 'message bot';
                    botMsgDiv.textContent = botMessage;
                    chatbox.appendChild(botMsgDiv);
                });

                // Clear input
                input.value = '';
                chatbox.scrollTop = chatbox.scrollHeight;
            }
        }
    });
</script>
<script>
    AOS.init({
        offset: 120, 
        delay: 0, 
        duration: 1000, 
        easing: 'ease-in-out', 
        once: true, 
        mirror: false, 
    });
</script>
</body>
</html>